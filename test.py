# import re
# import string

# candidate = [u'October', u'29', u',', u'2016']

# text = ""
# for c in candidate:
#     if not text:
#         text = c
#     elif c in string.punctuation:
#         text += c
#     else:
#         text += " " + c

# print text
# exit()

# candidate = "October 29, 2016"

# sent = u"pic.twitter.com/C2VD3DjppE -- Alana Cartwright (@AlanaCartwrigh3) October 29, 2016  @HelenRyles Hi Helen, yes this is just our smaller bar."

# match = re.search(candidate.lower(),sent.lower())
# print match.group()

from stanfordcorenlp import StanfordCoreNLP
from nltk.tokenize import sent_tokenize 
# import json
# to run server: java --add-modules java.se.ee -mx4g -cp "*" edu.stanford.nlp.pipeline.StanfordCoreNLPServer -port 9000 -timeout 15000
nlp = StanfordCoreNLP('http://localhost', port=9000)
# nlp = StanfordCoreNLP(r'stanford-corenlp-full-2018-02-27',quiet=False)
# props = {'annotators': 'coref', 'pipelineLanguage': 'en', 'outputFormat': 'text'}
# text = ('GOP Sen. Rand Paul was assaulted in his home in Bowling Green, Kentucky, on Friday, '
#         'according to Kentucky State Police. State troopers responded to a call to the senator\'s '
#         'residence at 3:21 p.m. Friday. Police arrested a man named Rene Albert Boucher, who they '
#         'allege "intentionally assaulted" Paul, causing him "minor injury". Boucher, 59, of Bowling '
#         'Green was charged with one count of fourth-degree assault. As of Saturday afternoon, he '
#         'was being held in the Warren County Regional Jail on a $5,000 bond.')
# text = "My sister has a friend called John. Really, tell me more about him? She think he is so funny!"
# hehe =  nlp.coref(text)
# text = "Several people died and dozens were injured after a tram derailed and overturned in Croydon. Five people were left trapped inside the vehicle after it came off the tracks in a tunnel near Sandlilands tram station at around 6am. Three of those trapped have been removed from the tram, which is on its side, but two still remain inside as of 11.30am. British Transport Police confirmed there had been \"some loss of life\". A spokesman added: \"It is too early for us to confirm numbers but we are working hard to assess the ongoing incident and we are continuing to focus on recovery efforts.\" They later confirmed that the driver of the tram was arrested in connection with the incident. Croydon Tram derailment 8 show all Croydon Tram derailment 1/8 The scene after a tram overturned in Croydon, south London, trapping five people and injuring another 40 Steve Parsons/PA 2/8 Police officers walk the site where the tram overturned Carl Court/Getty Images 3/8 Emergency services were called to the scene just after 6am Twitter/@procrastinateur 4/8 Emergency services close to the location where a tram overturned in Croydon, south London PA 5/8 Emergency services at Sandilands tram station in Croydon Ben Morgan 6/8 A police cordon is in place on Addiscombe Road Ben Morgan 7/8 40 people were injured and five trapped inside the tram Ben Morgan 8/8 Witnesses reported seeing victims stretchered from the tram James Long The London Fire Brigade, which has 70 officers in attendance, said at least 40 people were injured after the tram overturned on a sharp bend. Emergency services were called at 6.10am as torrential rain continued to batter London. Over 50 people were taken to hospital. A Met spokesman said: \"Police were called to an overturned tram at 6.10 and officers are in attendance.\" Scene: this aerial picture shows the tram on its side by the track (BBC/ITN) Hannah Collier, who lives nearby the tram station, said: \"Heard a massive crash outside my window, now emergency services everywhere for the overturned tram, hope everyone is ok.\" The 23-year-old added that she had seen people being carried away on stretchers from the scene of the incident. James Long, who lives metres away from the scene of the incident, told the Standard: \"It happened on a sharp bend on the approach to Sandilands tram stop. Carnage: Emergency services inspect the overturned tram (Steve Parsons/PA ) \"I've never seen so many emergency services attend a scene.\" A London Fire Brigade spokesman said they had been called at 6.04am to an overturned tram in a tunnel.    SANDILANDS    Emergency Services are dealing with a serious incident at #Sandilands tram stop. Please avoid the area #Croydoncops pic.twitter.com/xp4RPNxXI5 -- Croydon MPS (@MPSCroydon) November 9, 201 \"There are eight fire engines and four fire and rescue crews in attendance,\" they added. People are being warned to avoid the tram line and the area surrounding Sandilands station in east Croydon, where there is a large police cordon and many emergency vehicles. Heard a massive crash outside my window, now emergency services everywhere for the overturned tram, hope everyone is ok #croydon pic.twitter.com/gxQgnPygEJ -- Hannah Collier (@HannahCollier1) November 9, 2016 Police tell me that people who are worried about loved ones should go to St Mildred's Centre on Bingham Road. Don't have phone number yet -- Gavin Barwell MP (@GavinBarwellMP) November 9, 2016 Miguel John, who was on a bus to Bromley when it stopped by Sandilands tram stop, told the Standard: \"The road hadn't been shut off yet but emergency services were already at the scene, this would have been around 6.30am. \"By this point more emergency services were flooding to the scene and a police car shut off the road with vehicles being ushered down Elgin Road towards Addiscombe. \"But it was obvious it was very, very serious due to the amount of emergency services at the scene. @RachelMirrorVid @DailyMirror here you go, I can't actually see the tram though pic.twitter.com/mwz56sxacI -- Hannah Collier (@HannahCollier1) November 9, 2016 \"At first there would have been roughly between six or 10 [vehicles], as time passed a lot more arrived and continued to arrive. \"Visibly from where I was about two fire engines, two to three ambulances, several police cars and then more arrived as time went on. \"I think that's how everyone knew it was very serious, especially how quickly they acted to shut off the road.\" Emergency: witnesses reported seeing victims stretchered from the tram (James Long) A London Ambulance Service spokesman said: \"We were called at 6.13 to an incident at Addiscombe Road in Croydon. \"We have sent a number of resources to the scene including ambulance crews, advanced paramedics and single responders in cars. \"We are treating a number of patients.\" Scene: Police, ambulances and fire engines were in attendance (James Long) Rail safety investigators are reportedly on their way to the scene to begin gathering evidence. A British Transport Police spokesman said: \"We are currently on scene at a major incident at Sandilands tram stop in Croydon. \"Officers are working to deal with a tram derailment, alongside colleagues from other emergency services. \"A number of people are believed to have been injured. People are asked to avoid the area.\" Rain: there were torrential downpours throughout the night (James Long) Mayor of London Sadiq Khan said: \"I am in contact with emergency services and TfL, who are working extremely hard to get the situation under control and treat those who have been injured. My thoughts are with all those involved in this incident. \"We are asking people to please visit the TfL website, tfl.gov.uk, for the latest travel information.\" A Transport for London spokesman said: \"We are currently working with the emergency services following a derailment involving a tram in Croydon. \"There is currently no service on the tram between Reeves Corner and Addington Village / Harrington Road.\" Today's is believed to be the first tram crash involving fatalities on board since 1959, when two women passengers and the driver died after a tram caught fire in Glasgow, following a collision with a lorry. London's only tram network operates in the south of the capital, from Wimbledon to Beckenham Junction, Elmers End and New Addington, via Croydon. More than 27 million passengers used the service in 2015/16. The system uses a combination of on-street and segregated running for the 17 miles (27km) of track."

text ="The morning after losing the presidential election to Donald Trump, former secretary of state Hillary Clinton steps onto the stage to deliver her concession speech. (Melina Mara/The Washington Post) Hillary Clinton blamed the renewed FBI inquiry into her State Department email system for blunting her momentum in the presidential election and the closure of that inquiry two days before Election Day for energizing voters for Donald Trump. \"There are lots of reasons why an election like this is not successful,\" Clinton told top donors on a farewell conference call Saturday. \"But our analysis is that [FBI Director James B.] Comey's letter raising doubts that were groundless, baseless, proven to be, stopped our momentum,\" she said. [A series of strategic mistakes likely sealed Clinton's fate] \"We dropped, and we had to keep really pushing ahead to regain our advantage -- which going into the last weekend, we had. We were once again up in all but two of the battleground states, and we were up considerably in some that we ended up losing. And we were feeling like we had put it back together,\" she continued. Democratic presidential nominee Hillary Clinton said the letter from FBI Director James Comey announcing an inquiry into additional emails was \"pretty strange\" and \"unprecedented\" with days to go before Election Day. Clinton told supporters at a rally in Daytona Beach, Fla., that voters \"deserve to get full and complete facts.\" (The Washington Post) The surprise announcement of a revival of the shuttered FBI inquiry came at a time when the campaign was riding high, Clinton said. \"After the third debate, we felt so good about where we were,\" she said. Trump's performance in the Oct. 19 debate was widely panned, especially his refusal to say that he would respect the outcome of the election if he lost. Democrats called him a sore loser. \"We were up considerably in all but two of the battleground states where we were tied or one behind, according to our data,\" Clinton said. \"We were tied in Arizona. We just had a real wind at our back,\" before the first, stunning letter from Comey. Clinton's campaign insisted the reopened inquiry would turn up nothing, and many Democrats accused Comey of partisan motives. He was once a registered Republican. Comey has not commented publicly on either letter. His defenders have said there was no partisan intent and that he should not be blamed for Clinton's loss to an opponent who ultimately had a deeper well of support among voters. Clinton did not accuse Comey of partisanship Saturday. But she did say that what should have been good news essentially backfired. Comey issued another letter to Congress on the Sunday before Election Day, concluding that the nine-day examination of newly discovered emails had turned up nothing to change his earlier conclusion that there had been no criminal conduct. \"Just as we were back up on the upward trajectory, the second letter from Comey essentially doing what we knew it would -- saying there was no there there -- was a real motivator for Trump's voters,\" Clinton said. A day earlier, Clinton communications director Jennifer Palmieri had told the same group of donors something similar -- that the news angered Trump voters and caused a spike in turnout, while Clinton's projected turnout fell. \"Trump spent the last four days of this campaign engaged in a nonstop attack on me personally, and the result is the result,\" Clinton said. [Signs of trouble on Clinton's last day on the trail] The Democrat focused on the outside events she said affected her campaign in the last three weeks of the election. She said nothing about other, larger forces at work -- Trump's message of change in a restive time, his pledge to represent the aggrieved working class, the difficulty of any political party winning a third consecutive presidential term, her own limited attention to economic anxiety, or the sexism and discomfort that surrounded her attempt to become the first female president. 1 of 57 Full Screen Autoplay Close Skip Ad x Hillary Clinton's campaign comes to an end View Photos Hillary Clinton loses to Donald Trump in the 2016 presidential election. Caption Hillary Clinton loses to Donald Trump in the 2016 presidential election. Nov. 9, 2016 Hillary Clinton speaks in New York while her husband, former president Bill Clinton, applauds. Melina Mara/The Washington Post Buy Photo Wait 1 second to continue. Palmieri had pointed blame at much of that Friday. Neither she nor Clinton herself addressed how Clinton's decision seven years ago to use a private system for her government communication had opened the door to the FBI inquiry in the midst of her second run for the White House. Clinton has said the decision was a mistake. \"I am heartbroken,\" she said Saturday, with a sad laugh. \"I'm not going to pretend otherwise. This is a very, very tough loss and especially because everyone worked so hard.\" Before Clinton spoke Saturday, her finance director had congratulated the group of top fundraisers for bringing in more than half of the nearly $1 billion raised for Clinton's campaign. The National Finance Committee, as it was known, was made up of donors who amassed, or \"bundled\" at least $100,000 in donations from others. Finance director Dennis Cheng ran through numbers that illustrate how heavily Clinton relied upon big donors:"

# text = "A girl named Kendall Jenner praises Manchester's 'incredible resilience' after bombing. Jenner said it because she thinks that they will never going to let anyone forget about those victims"
# print hehe

# sent = sent_tokenize(text)
# print(text)
# for s in sent:
#     print(nlp.ner(s))
data = nlp.coref(text)
print(data)
print(data[0][0][3])
nlp.close()

# result = json.loads(nlp.annotate(text, properties=props))
# num, mentions = result['corefs'].items()[0]
# for mention in mentions:
#     print(mention)
# print(result)
# nlp.close()


# from pynlp import StanfordCoreNLP

# annotators = 'tokenize, ssplit, pos, lemma, ner, entitymentions, coref, sentiment, quote, openie'
# options = {'openie.resolve_coref': True}

# nlp = StanfordCoreNLP(annotators=annotators, options=options)
# document = nlp(text)

# chain = document.coref_chains[0]
# print(chain)